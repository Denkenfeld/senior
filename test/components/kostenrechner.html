<div class="vitakreis-calculator">
    <div class="vk-header">
        <h1>Vitakreis Kostenrechner</h1>
        <p>Transparente Preise für individuelle Alltagshilfe</p>
    </div>

    <div class="vk-content">
        <div class="vk-desktop-grid">
            <!-- Spalte 1: Eingaben -->
            <div class="vk-left-column">
                

                <div class="vk-input-group">
                    <label class="vk-input-label">Stunden pro Monat</label>
                    <input type="range" id="vkHoursRange" min="1" max="40" value="20" step="1">
                    <div class="vk-range-value"><span id="vkHoursValue">20</span> Std.</div>
                </div>

                <div class="vk-input-group">
                    <label class="vk-checkbox-group">
                        <input type="checkbox" id="vkWeekend" value="5">
                        <span class="vk-checkbox-label">Wochenende/Feiertage/Nacht <strong>+9€/Std.</strong></span>
                    </label>
                </div>
            </div>

            <!-- Spalte 2: Ergebnis -->
            <div class="vk-middle-column">
                <div class="vk-result-box">
                    <div class="vk-result-label">Monatliche Kosten Alles Inklusive</div>
                    <div class="vk-result-price" id="vkTotalPrice">276,00€</div>
                    <div class="vk-result-original" id="vkOriginalPrice" style="display: none;">Ursprünglich: 276,00€</div>

                    <div class="vk-result-breakdown">
                        <div class="vk-breakdown-item">
                            <div class="vk-breakdown-label">Stundensatz</div>
                            <div class="vk-breakdown-value" id="vkHourlyRate">34,50€</div>
                        </div>
                        <div class="vk-breakdown-item">
                            <div class="vk-breakdown-label">Stunden/Monat</div>
                            <div class="vk-breakdown-value" id="vkTotalHours">8</div>
                        </div>
                        <div class="vk-breakdown-item">
                            <div class="vk-breakdown-label">Ersparnis</div>
                            <div class="vk-breakdown-value" id="vkSavings">-</div>
                        </div>
                    </div>
                </div>

                <button class="vk-cta-button" onclick="openRequestModal('Erstes Kennenlernen')">
                    <span style="position: relative; z-index: 1;">Jetzt unverbindlich anfragen</span>
                </button>
            </div>

            <!-- Spalte 3: Krankenkasse -->
            <div class="vk-right-column">
                <div class="vk-insurance-section">
                    <div class="vk-insurance-title">Die Krankenkasse übernimmt unter Umständen anteilig die Kosten:</div>
                    
                    <label class="vk-checkbox-group">
                        <input type="checkbox" id="vkEntlastung" value="131" checked>
                        <span class="vk-checkbox-label"><strong>131€</strong> Kostenerstattung durch monatlichen Entlastungsbetrag nach § 45b SGB XI (Pflegegrad 1-5)</span>
                    </label>

                    <label class="vk-checkbox-group">
                        <input type="checkbox" id="vkPflegegradToggle" checked>
                        <span class="vk-checkbox-label"><strong>Zusätzlich je nach Pflegegrad:</strong></span>
                    </label>

                    <div class="vk-pflegegrad-list" id="vkPflegegradList" style="display: none;">
                        <label class="vk-pflegegrad-item">
                            <input type="radio" name="pflegegrad" value="318.40">
                            <span class="vk-pflegegrad-label">PG 2: bis zu 318,40 €</span>
                        </label>
                        <label class="vk-pflegegrad-item">
                            <input type="radio" name="pflegegrad" value="598.80">
                            <span class="vk-pflegegrad-label">PG 3: bis zu 598,80 €</span>
                        </label>
                        <label class="vk-pflegegrad-item">
                            <input type="radio" name="pflegegrad" value="743.60" checked>
                            <span class="vk-pflegegrad-label">PG 4: bis zu 743,60 €</span>
                        </label>
                        <label class="vk-pflegegrad-item">
                            <input type="radio" name="pflegegrad" value="919.60">
                            <span class="vk-pflegegrad-label">PG 5: bis zu 919,60 €</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
(function() {
    const vkTarifs = {
        s: { name: 'Standard', rate: 42.50, info: 'Einheitlich', min: 1, max: 999, segment: 1 },
        m: { name: 'Standard', rate: 42.50, info: 'Einheitlich', min: 1, max: 999, segment: 1 },
        l: { name: 'Standard', rate: 42.50, info: 'Einheitlich', min: 1, max: 999, segment: 1 }
    };

    function vkGetTarifByHours(hours) {
        if (hours >= 30) return vkTarifs.l;
        if (hours >= 9) return vkTarifs.m;
        return vkTarifs.s;
    }

    function vkUpdateProgressBar(currentSegment) {
        for (let i = 1; i <= 3; i++) {
            const segment = document.getElementById('vkSegment' + i);
            const label = document.getElementById('vkLabel' + i);

            segment.classList.remove('active', 'completed');
            label.classList.remove('active');

            if (i < currentSegment) {
                segment.classList.add('completed');
            } else if (i === currentSegment) {
                segment.classList.add('active');
                label.classList.add('active');
            }
        }
    }

    function vkFormatPrice(price) {
        return price.toLocaleString('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).replace('.', ',');
    }

    function vkCalculate() {
        const hours = parseInt(document.getElementById('vkHoursRange').value);
        const weekendChecked = document.getElementById('vkWeekend').checked;
        const entlastungChecked = document.getElementById('vkEntlastung').checked;
        const selectedPflegegrad = document.querySelector('input[name="pflegegrad"]:checked');

        const tarif = vkGetTarifByHours(hours);
        let hourlyRate = tarif.rate;

        if (weekendChecked) {
            hourlyRate += 9;
        }

        let originalTotal = hourlyRate * hours;
        let total = originalTotal;

        // Berechne maximale Erstattung (max 16,50€ pro Stunde)
        const maxReimbursementPerHour = 999;
        const maxPossibleReimbursement = maxReimbursementPerHour * hours;

        let totalReimbursement = 0;

        // Entlastungsbetrag
        if (entlastungChecked) {
            totalReimbursement += 131;
        }

        // Pflegegrad-Betrag
        if (selectedPflegegrad) {
            totalReimbursement += parseFloat(selectedPflegegrad.value);
        }

        // Limitiere auf maximale Erstattung
        const actualReimbursement = Math.min(totalReimbursement, maxPossibleReimbursement, originalTotal);
        total = Math.max(0, originalTotal - actualReimbursement);

        // Tarif-Ersparnis (unabhängig von Krankenkasse)
        const baseCost = vkTarifs.s.rate * hours;
        const actualCost = tarif.rate * hours;
        const tarifSavings = baseCost - actualCost;

        // vkUpdateProgressBar entfernt

        // vkTarifName entfernt
        // vkTarifInfo entfernt
        // vkTarifRate entfernt
        document.getElementById('vkTotalPrice').innerHTML = vkFormatPrice(total) + '€';
        document.getElementById('vkHourlyRate').innerHTML = vkFormatPrice(hourlyRate) + '€';
        document.getElementById('vkTotalHours').textContent = hours;

        // Zeige Original-Preis wenn Erstattung aktiv ist
        const originalPriceEl = document.getElementById('vkOriginalPrice');
        if (actualReimbursement > 0) {
            originalPriceEl.innerHTML = 'Ursprünglich: ' + vkFormatPrice(originalTotal) + '€';
            originalPriceEl.style.display = 'block';
        } else {
            originalPriceEl.style.display = 'none';
        }

        // Ersparnis anzeigen (Tarif-Ersparnis + Krankenkasse)
        const totalSavings = tarifSavings + actualReimbursement;
        document.getElementById('vkSavings').innerHTML = totalSavings > 0 ? vkFormatPrice(totalSavings) + '€' : '-';
    }

    // Event Listeners
    const vkHoursRange = document.getElementById('vkHoursRange');

    let animTimeout;
    function pauseAnim() {
        if (vkHoursRange) vkHoursRange.classList.add('paused');
        clearTimeout(animTimeout);
    }
    function resumeAnim() {
        if (vkHoursRange) vkHoursRange.classList.remove('paused');
    }
    function resumeAnimDelayed() {
        clearTimeout(animTimeout);
        animTimeout = setTimeout(resumeAnim, 3000);
    }
    if (vkHoursRange) {
        vkHoursRange.addEventListener('mousedown', pauseAnim);
        vkHoursRange.addEventListener('touchstart', pauseAnim, {passive: true});
        vkHoursRange.addEventListener('mouseup', resumeAnimDelayed);
        vkHoursRange.addEventListener('touchend', resumeAnimDelayed);
    }
    
    const vkHoursValue = document.getElementById('vkHoursValue');

    vkHoursRange.addEventListener('input', function() {
        pauseAnim();
        vkHoursValue.textContent = this.value;
        vkCalculate();
        resumeAnimDelayed();
    });

    document.getElementById('vkWeekend').addEventListener('change', vkCalculate);
    document.getElementById('vkEntlastung').addEventListener('change', vkCalculate);

    // Pflegegrad Toggle
    document.getElementById('vkPflegegradToggle').addEventListener('change', function() {
        const list = document.getElementById('vkPflegegradList');
        if (this.checked) {
            list.style.display = 'block';
        } else {
            list.style.display = 'none';
            // Deselect all radio buttons
            document.querySelectorAll('input[name="pflegegrad"]').forEach(radio => {
                radio.checked = false;
            });
            vkCalculate();
        }
    });

    // Pflegegrad Radio Buttons
    document.querySelectorAll('input[name="pflegegrad"]').forEach(radio => {
        radio.addEventListener('change', vkCalculate);
    });

    (function initPflegegrad() {
        const toggle = document.getElementById('vkPflegegradToggle');
        const list = document.getElementById('vkPflegegradList');
        if (toggle && list && toggle.checked) {
            list.style.display = 'block';
        }
    })();


    vkCalculate();
})();
</script>

<!-- Vitakreis Kostenrechner - Ende -->

        <style>
            .vk-timeline-wrapper { max-width: 1200px; margin: 60px auto 40px auto; padding: 2rem 1rem; }
            .vk-intro-header { text-align: center; margin-bottom: 3rem; }
            .vk-intro-header h2 { color: #889e88; margin-bottom: 0.5rem; font-family: var(--font-head); font-size: 2rem; }
            .vk-intro-header p { color: #5d4e37; font-size: 1.1rem; }
            .vk-timeline-container { position: relative; padding: 1rem 0; }
            .vk-line-bg { position: absolute; background: #e3e8e3; left: 20px; top: 0; bottom: 0; width: 4px; height: auto; border-radius: 4px; z-index: 0; }
            .vk-line-fill { position: absolute; background: #889e88; left: 20px; top: 0; width: 4px; height: 0%; border-radius: 4px; z-index: 1; transition: height 0.1s linear, width 0.1s linear; }
            .vk-steps-grid { display: grid; grid-template-columns: 1fr; gap: 3rem; position: relative; z-index: 2; }
            .vk-step-item { position: relative; padding-left: 60px; opacity: 0; transform: translateY(20px); transition: all 0.6s ease; }
            .vk-step-item.vk-visible { opacity: 1; transform: translateY(0); }
            .vk-step-dot { position: absolute; left: 12px; top: 0; width: 20px; height: 20px; background: white; border: 4px solid #d6ded6; border-radius: 50%; transition: border-color 0.3s; z-index: 3; }
            .vk-step-item.vk-active .vk-step-dot { border-color: #889e88; transform: scale(1.1); }
            .vk-step-card { background: white; border: 1px solid #e3e8e3; border-radius: 12px; padding: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
            .vk-step-title { color: #889e88; margin: 0 0 0.5rem 0; font-size: 1.1rem; font-weight: 700; }
            .vk-badge { display: inline-block; background: #f0f4f0; color: #5d4e37; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-bottom: 0.5rem; border: 1px solid #b0c4b0; }
            .vk-step-card p { font-size: 0.9rem; color: #5d4e37; line-height: 1.6; }
            @media (min-width: 768px) {
                .vk-steps-grid { grid-template-columns: 1fr 1fr 1fr; gap: 2rem; padding-top: 40px; }
                .vk-step-item { padding-left: 0; text-align: center; }
                .vk-line-bg { left: 0; right: 0; top: 10px; width: 100%; height: 4px; bottom: auto; }
                .vk-line-fill { left: 0; top: 10px; height: 4px; width: 0%; bottom: auto; }
                .vk-step-dot { left: 50%; top: -38px; transform: translateX(-50%); }
                .vk-step-item.vk-active .vk-step-dot { transform: translateX(-50%) scale(1.1); }
            }
        
        /* --- KONTAKT TIMELINE STYLE MIT SCROLL FILL --- */
        .contact-timeline {
            position: relative;
            padding-left: 40px;
            max-width: 400px;
        }

        .contact-timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: #e3e8e3;
            z-index: 0;
        }

        .contact-timeline::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            background: #889e88;
            height: 0%;
            transition: height 0.2s linear;
            z-index: 1;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            padding-left: 0;
            z-index: 2;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -46px;
            top: 5px;
            width: 12px;
            height: 12px;
            background: #889e88;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 0 3px #889e88;
            z-index: 3;
        }

        .timeline-item strong {
            display: block;
            color: #889e88;
            margin-bottom: 8px;
            font-size: 0.85rem;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .timeline-item div {
            color: #5d4e37;
            line-height: 1.6;
            font-size: 1rem;
        }

        .timeline-item a {
            color: #5d4e37;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .timeline-item a:hover {
            color: #889e88;
        }

    </style>

        <div class="vk-timeline-wrapper">
            <div class="vk-intro-header">
                <h2>Ihr Weg zur Entlastung</h2>
                <p>In drei einfachen Schritten zu mehr Lebensqualität.</p>
            </div>
            <div class="vk-timeline-container" id="vkTimelineRef">
                <div class="vk-line-bg"></div>
                <div class="vk-line-fill" id="vkFillBar"></div>
                <div class="vk-steps-grid">
                    <div class="vk-step-item" data-index="1">
                        <div class="vk-step-dot"></div>
                        <div class="vk-step-card">
                            <h3 class="vk-step-title">1. Kontaktaufnahme</h3>
                            <p>Schreiben Sie mir oder rufen Sie an. Ich melde mich zeitnah zurück.</p>
                        </div>
                    </div>
                    <div class="vk-step-item" data-index="2">
                        <div class="vk-step-dot"></div>
                        <div class="vk-step-card">
                            <div class="vk-badge">Kostenlos & Unverbindlich</div>
                            <h3 class="vk-step-title">2. Kennenlernen</h3>
                            <p>Ich komme zu Ihnen nach Hause. Wir besprechen Ihren Bedarf ganz in Ruhe bei einer Tasse Kaffee.</p>
                        </div>
                    </div>
                    <div class="vk-step-item" data-index="3">
                        <div class="vk-step-dot"></div>
                        <div class="vk-step-card">
                            <h3 class="vk-step-title">3. Starten</h3>
                            <p>Wenn die Chemie stimmt, legen wir los. Flexibel und ohne lange Vertragslaufzeiten.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
        (function(){
            const c=document.getElementById('vkTimelineRef'), f=document.getElementById('vkFillBar'), i=document.querySelectorAll('.vk-step-item');
            function u(){
                if(!c||!f)return;
                const r=c.getBoundingClientRect(), wh=window.innerHeight, d=wh*0.8-r.top, t=r.height+100;
                let p=(d/t)*100; p=Math.max(0,Math.min(100,p));
                const isD=window.innerWidth>=768;
                f.style[isD?'width':'height']=p+'%'; f.style[isD?'height':'width']='4px';
                i.forEach((el,x)=>{
                    if(p>(isD?(20+x*20):(10+x*30))) el.classList.add('vk-visible','vk-active');
                });
            }
            window.addEventListener('scroll',u); window.addEventListener('resize',u); u();
        })();
        </script>
    </div>
        

    

    
    
    







  














    
    

    
    <!-- Availability Widget zwischen Timeline und Kontakt -->
    <div class="reveal" style="text-align: center; margin: 40px 0 30px 0; padding: 0 20px;">
        <a href="tel:07433-9970779" class="vk-availability-pill">
            <div class="vk-dot"></div>
            <div>Gerade erreichbar – rufen Sie einfach an!</div>
        </a>
    </div>